---
layout: post
title: 计算机网络-Wireshark探索802.11
---

## Fetch a Trace

---

直接捕获无线局域网的流量有两个难题，一是有些系统(windows)不支持直接收集 802.11 frames，而第二个问题就是需要两台电脑互相发送流量。基于上述两点，推荐直接使用现成的数据包。

## Inspecet the Trace

---

首先整体看看全部的数据帧，从 info 栏中我们可以看到 802.11 frame 有不同的类型，Beacon，Data，Ack，分别对应管理帧、数据帧和控制帧三种帧的类型。
下面重点研究数据帧。

根据 802.11，我们可以知道，这是一个无线局域网里的数据帧，而且最下面也标记了帧的字节数为 1539。

![](https://1ees0n.oss-cn-qingdao.aliyuncs.com/Github/Network-80211-Step2-1.png)

该字段记录了帧长、帧数以及一些时间信息。

![](https://1ees0n.oss-cn-qingdao.aliyuncs.com/Github/Network-80211-Step2-2.png)

Radiotap 包括头部以及 body 记录了物理层的相关参数，包括信号长度、调制信息等。

![](https://1ees0n.oss-cn-qingdao.aliyuncs.com/Github/20241117162228.png)

然后是 IEEE 802.11 Data，它是 802.11 中的数据帧，共占据 24 字节。

![](https://1ees0n.oss-cn-qingdao.aliyuncs.com/Github/20241117162211.png)

最后是最大的数据，占据了 1478 字节。

![](https://1ees0n.oss-cn-qingdao.aliyuncs.com/Github/20241117162153.png)

然后我们详细的分析 IEEE 802.11 Data 部分

![](https://1ees0n.oss-cn-qingdao.aliyuncs.com/Github/20241117162309.png)

### Frame Control

---

![](https://1ees0n.oss-cn-qingdao.aliyuncs.com/Github/20241117162849.png)

- Version: IEEE 802.11 标准版本。
- Type: Data frame
- Subtype: 数据帧子类型 0000，基本的数据帧类型，当然还有其他数据帧类型。
- DS: 包括两位，To DS 和 From DS，在这里将其合并为一个 DS Status，
  - To DS: 表示帧是否要送到分布系统，This flag is set if the frame is sent from a computer to the wired network via the AP.
  - From DS: 表示帧是否来自分布系统。This flag is set if the frame is sent from the wired network to a computer via the AP.
- More Fragments: 这里为 0，表示之后没有分片了，这是最后一个分片。
- Retry: 为 0，说明该帧不是重传帧。
- Pwr. Mgt: 为 0，传输完成后不进行省电休眠，保持待机。
- More Date: 为 0，说明之后没有帧需要发送了。
- Protected: 1 表示数据被加密过了。Set if the frame is encrypted with WEP/WPA2.
- Order: 0 表示顺序不重要。

### Duration

---

```txt
.000 0000 0010 1100 = Duration: 44 microseconds
```

This field tells computers how much time is needed on the wireless medium for additional packets that are part of this exchange.

length: 1 byte

### Address

---

这些地址都是 MAC 地址，每一个都是 6 个字节。

![](https://1ees0n.oss-cn-qingdao.aliyuncs.com/Github/20241117163735.png)

- 第一个地址为接收地址：数据包的目的地址
- 第二个是发送地址：实际发送数据包的设备的 MAC 地址
- 第三个是目标地址：通常与接受地址相同，也可不同
- 第四个为源地址：数据包最初来源的设备地址，与发送地址一致说明，设备既是源设备又是实际发送设备
- BSS Id：这是接入点（AP，通常是路由器）的标识符，代表无线网络的管理实体。
- STA Address：站点地址，这是站点（STA，通常指客户端设备，如笔记本电脑或手机）的 MAC 地址。

### Fragment and sequence

---

共占 2 个字节，16 位，其中 12 位是数据帧编号，4 位是分片编号。用于重新组装和重传。

![](https://1ees0n.oss-cn-qingdao.aliyuncs.com/Github/20241117164857.png)

### Frame check sequence

---

CRC 校验和--4 字节。

```txt
Frame check sequence: 0x43431309 [unverified]
```

## 802.11 Physical Layer

---

### Channel frequency

---

频道频率是固定为 2462(2.4GHz)

The frequency or channel is the same for all frames in the trace, since the wireless network in-
terface is set to listen on a fixed frequency.

![](https://1ees0n.oss-cn-qingdao.aliyuncs.com/Github/20241117171253.png)

### RSSI and Rate

---

首先，将 RSSI(接收信号强度指示) 和 Rate(数据传输速率) 的列给调出来。

这里 RSSI 一个指标，用于测量接收到的无线信号的强度，通常以 dBm（分贝毫瓦）为单位。它是一个负值，数值越接近 0，表示信号越强。

![](https://1ees0n.oss-cn-qingdao.aliyuncs.com/Github/20241117171653.png)

以太网的 Rate 是固定的，但无线传输有很多种 Rate。

Rate 的值从小到大为：

- 1
- 6
- 12
- 18
- 24
- 36
- 48
- 54

## 802.11 Link Layer

---

### 802.11 Management

---
