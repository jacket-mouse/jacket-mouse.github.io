---
layout: post
title: 编译器-PL0语法分析
---

语法分析在该次实验中主要分为两部分--符号表的建立和中间代码的生成，因为我们分开来说明并实现。

## 符号表的建立

---

根据词法分析，我们能够得到一个又一个的 Token，这时我们就要对这些 Token 进行处理。符号表就是其中一部分。

- 那符号表是什么呢？

  符号表在这次实验中，存储的是常量、变量以及过程(Prodedure)的信息。

  那我们应该如何表示上述的信息呢？在这里我使用了 Java 中的 List 表示一整个表，List 里存放的是 Map，因为 Map 就是键值对，很好的满足我们的要求。正如下图所示，现在我们还不知道里面各字段的含义，但主要结构应该是这样的。
  ![](https://1ees0n.oss-cn-qingdao.aliyuncs.com/Github/PL0-Table.png)

- 我们为什么要建立符号表呢？

  其目的是方便之后的语义分析以及中间代码的生成，所以符号表其实是一个“工具”，有了它我们会变得更加方便，没有的话会遇到很多的麻烦，甚至无法分析。

  举一个例子：之后我们会给变量赋值，如果变量在之前没有声明过，这是要报错的。如果我们不通过符号表记录下来，就无法知道这个变量声明还是没有声明，就无法处理了。

接下来，我们就要开始从零构建一个符号表了。

从之前的图中，我们可以看到，符号表其实主要为三个部分：
常量、变量和过程(procedure)。

### 常量部分

---

常量有三个 Key，分别是：

- name：记录常量的符号名。
- kind：类型，即我们在词法分析中给他的“标签”
- value：常量的值。

这三个 Key 都是比较简单的，因为我们获取到一个 Token，Token 本身就包括 text(name)和 type(kind)属性，所以上面的三个 key 有两个直接给我们了，就还剩下一个 value 属性，而通过分析 PL/0 语言的文法：

- ConstDecl → const ConstDef {, ConstDef} ;
  常量定义
- ConstDef → ident = number

number 必然会跟在 ident 之后，所以第三个 value 的值，也是很简单就能够获取到，这样我们就完成了一个完整的常量 Map 的构造，接下来将其添加到 List 中就可以了。
